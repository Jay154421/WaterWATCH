<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="css/changepassword.css" />
    <title>WaterWATCH</title>
  </head>
  <body>
    <!-- Header -->
    <div class="header">
      <div class="logo1">
        <a href="DashBoard.html">
          <img src="Asset/logo1.png" alt="" />
        </a>
      </div>
    </div>

    <!-- Main -->
    <form id="changepassword-form">
      <div class="main">
        <label for="oldpassword">Old Password</label>
        <input
          type="password"
          id="oldpassword"
          placeholder="old password"
          required
        />
        <br />
        <label for="newpassword">New Password</label>
        <input
          type="password"
          id="newpassword"
          placeholder="new password"
          required
        />
        <button type="submit">Submit</button>
      </div>
    </form>

    <!-- Footer -->
    <div class="footer">
      <div class="icon">
        <a href="MapLeak.html">
          <img
            src="Asset/leakmap.png"
            width="20"
            height="20"
            alt="WaterWATCH"
          />
        </a>
        <label>Leak</label>
      </div>
      <div class="icon">
        <a href="DashBoard.html">
          <img src="Asset/home.png" width="20" height="20" alt="WaterWATCH" />
        </a>
        <label>Home</label>
      </div>
      <div class="icon">
        <a href="history.html">
          <img
            src="Asset/history.png"
            width="20"
            height="20"
            alt="WaterWATCH"
          />
        </a>
        <label>History</label>
      </div>
    </div>

    <script>
      document
        .getElementById("changepassword-form")
        .addEventListener("submit", function (event) {
          event.preventDefault();

          var oldpassword = document.getElementById("oldpassword").value;
          var newpassword = document.getElementById("newpassword").value;

          var storedData =
            JSON.parse(localStorage.getItem("jay154421")) || null;
          const username = storedData.username;
          const email = storedData.email;

          // Check if storedData is not null and has a password property
          if (storedData && oldpassword === storedData.password) {
            // Create a new object to store the new password
            var newData = {
              username: username,
              email: email,
              password: newpassword,
            };
            localStorage.setItem("jay154421", JSON.stringify(newData));
            alert("Successfully changed password");
            window.location.href = "Setting.html";
          } else {
            alert("Wrong password was entered");
          }
        });
    </script>
  </body>
</html>
